<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Ajax 1 - Text File</title>
    </head>
    <body>
        <button id="button">Get Text File</button>
        <br><br>
        <div id="text"></div>

        <script>
            // Create event listener
            document.getElementById('button').addEventListener('click', loadText);

            function loadText() {
                // Create XHR object
                const xhr = new XMLHttpRequest();
                // OPEN - type, url/filepath, async (true/false)
                xhr.open('GET', 'sample.txt', true);
                console.log('READYSTATE: ', xhr.readyState); // 1

                // OPTIONAL - used for loaders
                xhr.onprogress = function () {
                    console.log('READYSTATE: ', xhr.readyState);
                }

                // onload runs only when ready, ready state set to 4
                xhr.onload = function () {
                    console.log('READYSTATE: ', xhr.readyState); // 4
                    if(this.status === 200){
                        //console.log(this.responseText);
                        document.getElementById('text').innerHTML = this.responseText;
                    } else if (this.status === 404){
                        document.getElementById('text').innerHTML = '404, resource not found.';
                    }
                }

                xhr.onerror = function () {
                    console.log('Request error...');
                }

                // old approach, using onreadystatechange
                // xhr.onreadystatechange = function () {
                //     console.log('READYSTATE: ', xhr.readyState); // go through all the states [0,4] and upon reaching 4, log the result
                //     if(this.readyState === 4 && this.status === 200){
                //         console.log(this.responseText);
                //     }
                // }
                // Sends request
                xhr.send();
            }

            /*
             *  - readyState values:
             *  0: request not initialized
             *  1: server connection established
             *  2: request received
             *  3: processing request
             *  4: request finished and response is ready
             */
        </script>
    </body>
</html>